<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">RakNet Amplification Attack Summary and Response | GeyserMC</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://geyser.fastly.8aka.cn/preview-images/8cdc5b6b092dc3cad73c6872c8232b5b02650300.png"><meta data-rh="true" name="twitter:image" content="https://geyser.fastly.8aka.cn/preview-images/8cdc5b6b092dc3cad73c6872c8232b5b02650300.png"><meta data-rh="true" property="og:url" content="https://geyser.fastly.8aka.cn/blog/raknet-amplification-attack"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="theme-color" content="#25c2a0"><meta data-rh="true" property="og:title" content="RakNet Amplification Attack Summary and Response | GeyserMC"><meta data-rh="true" name="description" content="A look at how we dealt with an exploit in the RakNet protocol"><meta data-rh="true" property="og:description" content="A look at how we dealt with an exploit in the RakNet protocol"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-05-05T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/Kas-tle"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://geyser.fastly.8aka.cn/blog/raknet-amplification-attack"><link data-rh="true" rel="alternate" href="https://geyser.fastly.8aka.cn/blog/raknet-amplification-attack" hreflang="en"><link data-rh="true" rel="alternate" href="https://geyser.fastly.8aka.cn/blog/raknet-amplification-attack" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://0DTHI9QFCH-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://geyser.fastly.8aka.cn/blog/raknet-amplification-attack","mainEntityOfPage":"https://geyser.fastly.8aka.cn/blog/raknet-amplification-attack","url":"https://geyser.fastly.8aka.cn/blog/raknet-amplification-attack","headline":"RakNet Amplification Attack Summary and Response","name":"RakNet Amplification Attack Summary and Response","description":"A look at how we dealt with an exploit in the RakNet protocol","datePublished":"2024-05-05T00:00:00.000Z","author":{"@type":"Person","name":"Kas-tle","description":"Developer","url":"https://github.com/Kas-tle","image":"https://github.com/Kas-tle.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://geyser.fastly.8aka.cn/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="GeyserMC RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="GeyserMC Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="GeyserMC" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.e5ccfb6d.css">
<script src="/assets/js/runtime~main.060a0c5f.js" defer="defer"></script>
<script src="/assets/js/main.ea16d938.js" defer="defer"></script>
<meta name="image" content="https://geyser.fastly.8aka.cn/preview-images/8cdc5b6b092dc3cad73c6872c8232b5b02650300.png"></head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/apple-touch-icon.png" alt="GeyserMC logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/apple-touch-icon.png" alt="GeyserMC logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">GeyserMC</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link header-wiki-link" aria-haspopup="true" aria-expanded="false" role="button" href="/wiki/">Wiki</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/wiki/geyser/">Geyser</a></li><li><a class="dropdown__link" href="/wiki/floodgate/">Floodgate</a></li><li><a class="dropdown__link" href="/wiki/api/">REST APIs</a></li><li><a class="dropdown__link" href="/wiki/other/">Other</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link header-blog-link navbar__link--active" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link header-utilities-link">Utilities</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/utilities/config-editor">Config Editor</a></li><li><a class="dropdown__link" href="/utilities/dump-viewer">Dump Viewer</a></li></ul></div><a class="navbar__item navbar__link header-download-link" href="/download">Download</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/GeyserMC/Geyser" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><a href="https://discord.gg/geysermc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discord-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite" aria-pressed="true"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/raknet-amplification-attack">RakNet Amplification Attack Summary and Response</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/geyser-1-20-5">Geyser Available for Java 1.20.5/1.20.6</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/four-years-of-geyser">Four Years of Geyser</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/looking-back-at-2022">Looking back at 2022</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2021</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/1-18-release-and-more">1.18 Release, MCProtocolLib, Refactors &amp; More!</a></li></ul></div></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">RakNet Amplification Attack Summary and Response</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-05-05T00:00:00.000Z">May 5, 2024</time> · 18 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Kas-tle" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://github.com/Kas-tle.png" alt="Kas-tle"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/Kas-tle" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Kas-tle</span></a></div><small class="authorTitle_nd0D" title="Developer">Developer</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>In March, we were made aware of an exploit in the RakNet networking library used by Geyser, making Geyser instances vulnerable to use in a Distributed Denial of Service (DDoS) amplification attack. This bug was patched on all builds of Geyser numbered 478 and later. If you are still running an outdated build of Geyser, you should update immediately by downloading the latest build from <a href="https://geyser.fastly.8aka.cn/download" target="_blank" rel="noopener noreferrer">https://geyser.fastly.8aka.cn/download</a>. The original <a href="https://github.com/CloudburstMC/Network/security/advisories/GHSA-6h3m-c6fv-8hvh" target="_blank" rel="noopener noreferrer">security advisory</a> for this vulnerability was published on the <a href="https://github.com/CloudburstMC/Network" target="_blank" rel="noopener noreferrer">CloudburstMC/Network</a> repository. This post will detail the timeline, anatomy of the attack, our response, and additional measures we have taken to prevent similar attacks in the future.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="timeline-utc">Timeline (UTC)<a href="#timeline-utc" class="hash-link" aria-label="Direct link to Timeline (UTC)" title="Direct link to Timeline (UTC)">​</a></h2>
<ul>
<li><strong>March 24th, 11:00AM</strong>: bStats data begins to show instability in the number of online Geyser instances</li>
<li><strong>March 28th,  5:00AM</strong>: First reported Geyser instance causing server suspension by OVH</li>
<li><strong>March 28th,  4:00PM</strong>: First GitHub issue is opened referencing spamming of suspicious connections</li>
<li><strong>March 28th,  5:00PM</strong>: Attack against the Global Linking Server, which also hosts the Global API and Geyser Test Server, takes all three services offline</li>
<li><strong>March 28th,  6:07PM</strong>: The Global API server is started to begin restoration of the database from the MariaDB log</li>
<li><strong>March 28th,  6:27PM</strong>: The packets sent from Geyser responsible for the suspension of the Geyser Test Server machine are identified as being 134 bytes each sent at a rate of 60,000 packets per second</li>
<li><strong>March 28th,  6:30PM</strong>: A build of Geyser with enhanced logging for the Cloudburst Network library is installed on the test server to gather data about the attack vector.</li>
<li><strong>March 28th,  7:48PM</strong>: Database restoration is completed and the Global API is brought back online, but remains unstable due to the initial backlog of requests from the downtime</li>
<li><strong>March 28th,  8:46PM</strong>: Global API stability returns to normal</li>
<li><strong>March 29th,  1:30AM</strong>: Initial rate limiting is implemented in Geyser from upstream changed in Cloudburst Network, but the specific attack vector is still unclear</li>
<li><strong>March 29th,  3:32AM</strong>: Packet responsible is identified as Connection Request Accepted, sent by Geyser in the initial RakNet handshake</li>
<li><strong>March 29th,  6:00AM</strong>: Initial proof of concept is created showing a client can maliciously spam Connection Request packets, causing the server to reply with larger Connection Request Accepted packets</li>
<li><strong>March 29th, 12:25PM</strong>: Further rate limiting is added to Geyser via Cloudburst Network, particularly for replies to Connection Request packets</li>
<li><strong>March 30th,  9:20AM</strong>: A raw packet capture is obtained from a Geyser instance under attack, unmasking the root cause of the issue as the RakNet reliability setting of the Connection Request Accepted packet in Cloudburst Network</li>
<li><strong>March 30th, 10:30AM</strong>: A final fix to Cloudburst Network is pushed to Geyser, and a previously exploited instance is monitored with full packet dumps to confirm the fix</li>
<li><strong>March 30th, 10:28PM</strong>: Security advisory is published on the Cloudburst Network GitHub repository</li>
<li><strong>March 30th, 10:31PM</strong>: First @everyone ping in 1 year is made in the Geyser Discord announcing the security advisory and requesting all server owners update their instances as soon as possible</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="initial-warning-signs">Initial Warning Signs<a href="#initial-warning-signs" class="hash-link" aria-label="Direct link to Initial Warning Signs" title="Direct link to Initial Warning Signs">​</a></h2>
<p>Before the issue was initially detected, a suspicious trend can be seen in Geyser’s bStats data. On March 24th starting at approximately 11:00AM UTC, noticeable dips are seen in the total number of online Geyser instances. Normally, the number of online instances smoothly climbs and falls by about 500 instances, likely correlating with when people have free time to play Minecraft. Beginning on March 24th, frequent hourly swings of as much as 2200 instances online are seen. Given hindsight, this is likely when wide scale exploitation of this attack began.</p>
<table><thead><tr><th style="text-align:center"><img decoding="async" loading="lazy" alt="Geyser bStats Usage" src="/assets/images/geyser-bstats-usage-0574dd172f3cf90108e8161142590ecd.png" width="1276" height="399" class="img_ev3q"></th></tr></thead><tbody><tr><td style="text-align:center"><em>bStats chart of servers using Geyser over the month of March. Clear instability in the number of online servers reported is seen at the left starting on March 24th, at least three days before any formal reports of the attack were received.</em></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="initial-disclosure">Initial Disclosure<a href="#initial-disclosure" class="hash-link" aria-label="Direct link to Initial Disclosure" title="Direct link to Initial Disclosure">​</a></h2>
<p>Multiple users in the Geyser Discord first brought the attack to our attention by providing us with notices from their hosting provider that their server instances were suspended due to abuse. This means that their Geyser instances were sending outbound traffic interpreted by their hosting provider interpreted as a denial of service attack. Here is a snippet from one of these notices:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">##############################################################################</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#       DDoS-Attack detected from host XXX.XXX.XXX.XXX                       #</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">##############################################################################</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">TIME                             	SRC       	SRC-PORT  -</span><span class="token operator">&gt;</span><span class="token plain">  DST       	DST-PORT  SIZE  PROT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">----------------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2024</span><span class="token plain">-03-28 06:49:06.493070866 +0100  XXX.XXX.XXX.XXX	</span><span class="token number">19132</span><span class="token plain">  -</span><span class="token operator">&gt;</span><span class="token plain">  </span><span class="token number">51.75</span><span class="token plain">.XXX.XXX    	</span><span class="token number">1</span><span class="token plain">   </span><span class="token number">134</span><span class="token plain">   UDP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2024</span><span class="token plain">-03-28 06:49:06.50822918  +0100  XXX.XXX.XXX.XXX	</span><span class="token number">19132</span><span class="token plain">  -</span><span class="token operator">&gt;</span><span class="token plain">  </span><span class="token number">51.75</span><span class="token plain">.XXX.XXX    	</span><span class="token number">1</span><span class="token plain">   </span><span class="token number">134</span><span class="token plain">   UDP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2024</span><span class="token plain">-03-28 06:49:06.515954324 +0100  XXX.XXX.XXX.XXX	</span><span class="token number">19132</span><span class="token plain">  -</span><span class="token operator">&gt;</span><span class="token plain">  </span><span class="token number">51.75</span><span class="token plain">.XXX.XXX    	</span><span class="token number">1</span><span class="token plain">   </span><span class="token number">134</span><span class="token plain">   UDP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2024</span><span class="token plain">-03-28 06:49:06.519665639 +0100  XXX.XXX.XXX.XXX	</span><span class="token number">19132</span><span class="token plain">  -</span><span class="token operator">&gt;</span><span class="token plain">  </span><span class="token number">51.75</span><span class="token plain">.XXX.XXX    	</span><span class="token number">1</span><span class="token plain">   </span><span class="token number">134</span><span class="token plain">   UDP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2024</span><span class="token plain">-03-28 06:49:06.523410527 +0100  XXX.XXX.XXX.XXX	</span><span class="token number">19132</span><span class="token plain">  -</span><span class="token operator">&gt;</span><span class="token plain">  </span><span class="token number">51.75</span><span class="token plain">.XXX.XXX    	</span><span class="token number">1</span><span class="token plain">   </span><span class="token number">134</span><span class="token plain">   UDP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2024</span><span class="token plain">-03-28 06:49:06.526647418 +0100  XXX.XXX.XXX.XXX	</span><span class="token number">19132</span><span class="token plain">  -</span><span class="token operator">&gt;</span><span class="token plain">  </span><span class="token number">51.75</span><span class="token plain">.XXX.XXX    	</span><span class="token number">1</span><span class="token plain">   </span><span class="token number">134</span><span class="token plain">   UDP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2024</span><span class="token plain">-03-28 06:49:06.53355138  +0100  XXX.XXX.XXX.XXX	</span><span class="token number">19132</span><span class="token plain">  -</span><span class="token operator">&gt;</span><span class="token plain">  </span><span class="token number">51.75</span><span class="token plain">.XXX.XXX    	</span><span class="token number">1</span><span class="token plain">   </span><span class="token number">134</span><span class="token plain">   UDP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2024</span><span class="token plain">-03-28 06:49:06.537470479 +0100  XXX.XXX.XXX.XXX	</span><span class="token number">19132</span><span class="token plain">  -</span><span class="token operator">&gt;</span><span class="token plain">  </span><span class="token number">51.75</span><span class="token plain">.XXX.XXX    	</span><span class="token number">1</span><span class="token plain">   </span><span class="token number">134</span><span class="token plain">   UDP</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>Abuse report from OVH regarding the suspension of server running a Geyser instance.</em></p>
<p>This is the first information we were presented with regarding the attack vector. Based on this, we  can determine the rough speed of the attack by subtracting the time of the last packet in the report from the first packet (0.044399613 seconds) and dividing the packets sent in that timeframe (8 packets) by the time, we can see about 180 packets per second are being sent here. We are also given the size of the packet on the wire, which is 134 bytes. It’s important to note that this is the size of the packet as it exits the provider network, so it should only contain the destination headers for the public IP address.</p>
<p>Logs were also provided by another user, which show that after many repeated connection attempts, Cloudburst Network was unable to keep up and packet byte buffer handling was compromised.</p>
<div class="language-log codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-log codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[nioEventLoopGroup-5-1/ERROR] [org.cloudburstmc.netty.channel.raknet.RakChannelPipeline]: Exception thrown in RakNet pipeline</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">io.netty.handler.codec.DecoderException: java.lang.NullPointerException: Cannot invoke &quot;io.netty.buffer.ByteBuf.release()&quot; because &quot;this.buffer&quot; is null</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:98)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at io.netty.handler.codec.MessageToMessageCodec.channelRead(MessageToMessageCodec.java:111)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at org.cloudburstmc.netty.handler.codec.raknet.server.RakServerRouteHandler.channelRead(RakServerRouteHandler.java:60)  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at org.cloudburstmc.netty.handler.codec.raknet.AdvancedChannelInboundHandler.channelRead(AdvancedChannelInboundHandler.java:48)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at org.geysermc.geyser.network.netty.handler.RakConnectionRequestHandler.channelRead(RakConnectionRequestHandler.java:80)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at org.cloudburstmc.netty.handler.codec.raknet.ProxyInboundRouter.channelRead(ProxyInboundRouter.java:66)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Caused by: java.lang.NullPointerException: Cannot invoke &quot;io.netty.buffer.ByteBuf.release()&quot; because &quot;this.buffer&quot; is null</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  at org.cloudburstmc.netty.channel.raknet.packet.EncapsulatedPacket.deallocate(EncapsulatedPacket.java:138)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ... 45 more</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>Stacktrace from an attacked server after many hours of connection attempts, showing instability in the ability of Cloudburst Network to process packets.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reproduction-attempts">Reproduction Attempts<a href="#reproduction-attempts" class="hash-link" aria-label="Direct link to Reproduction Attempts" title="Direct link to Reproduction Attempts">​</a></h2>
<p>Given that the packet spam was occurring without Bedrock login taking place, the vulnerability was likely in the initial establishment of the RakNet connection. Minecraft Bedrock Edition uses a modified version of the RakNet protocol which has gone largely unchanged for many years and is unofficially documented at <a href="https://wiki.vg/Raknet_Protocol" target="_blank" rel="noopener noreferrer">https://wiki.vg/Raknet_Protocol</a>. Before game packets are sent, the connection is established with 7 packets, four of which are sent by the client and three of which are sent by the server. It was likely that one of these three packets was being spammed by the Geyser instance. The initial RakNet connection follows the sequence:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Client -</span><span class="token operator">&gt;</span><span class="token plain"> Server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Open Connection Request </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Server -</span><span class="token operator">&gt;</span><span class="token plain"> Client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Open Connection Reply </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Client -</span><span class="token operator">&gt;</span><span class="token plain"> Server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Open Connection Request </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Server -</span><span class="token operator">&gt;</span><span class="token plain"> Client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Open Connection Reply </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RakNet connection is established and further messages now wrapped </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> Frame Set Packet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">FSP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Client -</span><span class="token operator">&gt;</span><span class="token plain"> Server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Connection Request</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">FSP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Server -</span><span class="token operator">&gt;</span><span class="token plain"> Client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> Connection Request Accepted</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">FSP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Client -</span><span class="token operator">&gt;</span><span class="token plain"> Server</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> New Incoming Connection</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>Summary of the RakNet initial connection sequence. Note that the ability to utilize RakNet reliability settings begin only once packets are wrapped in a Frame Set Packet.</em></p>
<p>Given that the packet being spammed is coming from the server, and given it has a known outbound length of 134 bytes, we can analyze a normal connection to Geyser in Wireshark to determine the most likely responsible packet:</p>
<table><thead><tr><th style="text-align:center"><img decoding="async" loading="lazy" alt="Wireshark Initial RakNet Connection" src="/assets/images/wireshark-initial-raknet-connection-5d4aae6dc9622d1596475928edb9538d.png" width="1193" height="714" class="img_ev3q"></th></tr></thead><tbody><tr><td style="text-align:center"><em>Wireshark packet capture of a Geyser server at the initial RakNet connection stage. A hex dump of the Connection Request Accepted packet, sent by the server to the client, is shown. Note that byte numbers start at 0.</em></td></tr></tbody></table>
<p>We can see that on the client end, Connection Request Accepted is 148 bytes over the wire. However, if we subtract the 14 bytes of headers (bytes 0 to 13) added by the local network for routing, we get a size of 134 bytes when the packet left the provider network. Knowing this packet is likely responsible, we can consider how we might get the server to send many of them. One somewhat naive approach we took initially was sending many Connection Request packets once receiving Open Connection Reply 2 from the server. This does indeed result in the server sending many connection request accepted packets, showing there indeed was potential for abuse in Cloudburst Network’s existing implementation:</p>
<table><thead><tr><th style="text-align:center"><img decoding="async" loading="lazy" alt="Wireshark Reproduction Attempt" src="/assets/images/wireshark-reproduction-attempt-d53e1ee2667c18b7a75d1b36abfa6fa2.png" width="1189" height="1067" class="img_ev3q"></th></tr></thead><tbody><tr><td style="text-align:center"><em>Wireshark packet capture of a Geyser instance after being sent hundreds of Connection Request packets by a single client. The Geyser instance consequently replies with an equal number of Connection Request Accepted packets.</em></td></tr></tbody></table>
<p>That said, this is at best an amplification factor of two. By now, we had some bandwidth data of the attack, showing an amplification factor of at least 350 in the wild. Given this, there must have been a way to get this packet to be sent many more times.</p>
<table><thead><tr><th style="text-align:center"><img decoding="async" loading="lazy" alt="Pterodactyl Outbound Spike" src="/assets/images/pterodactyl-outbound-spike-6188656c37b9a6805e87fee93b1cec32.png" width="1999" height="1125" class="img_ev3q"></th></tr></thead><tbody><tr><td style="text-align:center"><em>Pterodactyl Panel dashboard of a Paper server running Geyser during an attack, showing a large outbound traffic spike. Within the short attack period, inbound traffic is only 819KiB, while outbound traffic is nearly 300MiB.</em></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="live-analysis">Live Analysis<a href="#live-analysis" class="hash-link" aria-label="Direct link to Live Analysis" title="Direct link to Live Analysis">​</a></h2>
<p>One thing that worked in our favor, ironically, was the wide scale exploitation of this vulnerability. Since our own official test server, and even some of our personal servers, were actively being attacked at regular intervals, we had ample locations to gather data about the attack. We began taking full raw packet capture of a server actively being attacked, which would ultimately unveil the root cause of the attack.</p>
<table><thead><tr><th style="text-align:center"><img decoding="async" loading="lazy" alt="Wireshark Live Attack" src="/assets/images/wireshark-live-attack-85b0aeb2b2d81f5069fb124f309ed715.png" width="1193" height="1440" class="img_ev3q"></th></tr></thead><tbody><tr><td style="text-align:center"><em>Wireshark packet capture of a Geyser instance under attack. The highlighted packet is a NAK packet sent by the client to the Geyser instance requesting the server resend packets with sequence numbers ranging from 0 to 8191. The immediately following packet is similar, requesting packets 8192 to 16383. The attacker sent these at the beginning of the connection and then simply waited while the Geyser instance continued to send thousands of packets, with each one incrementing the sequence number, leading to yet more packets being sent until the malicious NAK requests were fulfilled.</em></td></tr></tbody></table>
<p>Looking at the packets sent by the attacker, we see that things largely follow the specified connection sequence. But we also see a new type of packet as well: a NAK packet with a range of 0 to 8191. This brings us to the topic of RakNet packet reliability.</p>
<p>Since UDP itself does not have an inbuilt handshake like TCP to ensure all data arrives bit perfect in the correct order, RakNet implements a reliability system as a substitute. For this system, each packet is sent with a reliability type. While RakNet has eight reliability types, understanding this vulnerability only requires us to understand the difference between reliable and unreliable packets. Simply put, the client can request that reliable packets be resent, while it cannot request the resend of unreliable packets. Looking at the Cloudburst Network library, we see that this packet was indeed sent as reliable.</p>
<table><thead><tr><th style="text-align:center"><img decoding="async" loading="lazy" alt="RakServerOnlineInitialHandler" src="/assets/images/rak-server-online-initial-handler-9a64078cbe9a631a6579fe6a2757e25f.png" width="1999" height="1125" class="img_ev3q"></th></tr></thead><tbody><tr><td style="text-align:center"><em>RakServerOnlineInitialHandler#sendConnectionRequestAccepted is responsible for sending the Open Connection Request packet in the initial connection sequence. The RakReliability.RELIABLE enum causes the packet to be cached by the server before it is sent, therefore allowing the client to later re-request it via NAK.</em></td></tr></tbody></table>
<p>Because the packet was marked as reliable, this means that Network allows the client to respond with an ACK (Positive Acknowledgement) or NAK (Negative Acknowledgement). At this stage in the connection, this is a vector for abuse because the client has not yet done anything to prove that we are communicating with them directly versus receiving UDP packets with spoofed IP headers. By sending a NAK with the maximum range, they force us to continuously send the Connection Request Accepted packet.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="effects">Effects<a href="#effects" class="hash-link" aria-label="Direct link to Effects" title="Direct link to Effects">​</a></h2>
<p>This begs the question though: why would an attacker bother doing this? The two leading theories are UDP amplification, meaning the goal is to use Geyser instances as a means to attack other servers, or provider-based suspension, meaning the goal is to get the servers running Geyser instances suspended by their hosting provider.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="udp-amplification">UDP Amplification<a href="#udp-amplification" class="hash-link" aria-label="Direct link to UDP Amplification" title="Direct link to UDP Amplification">​</a></h3>
<p>As explained earlier, UDP has no inbuilt handshake. This means that UDP allows for traffic to be sent to a given IP address without them acknowledging or accepting it. When the ratio of request size to response size is near one, this is largely a nonissue since an attacker gains very little by going through a third party to send the data. In this case, however, the attacker can send a very small amount of data (~52 bytes) and trigger a response of over 8000 134 byte packets. Because the connection sequence up to Connection Request Accepted is always the same and does not require the attacker to actually see the packets we respond with to respond correctly, the attacker can spoof the source IP header of the UDP packets it sends to the Geyser instance. This means that, because of this amplification vector, the Geyser instance can unwittingly be used to multiply the attacker&#x27;s traffic by a theoretical maximum factor of 22,000. However, in practice, we saw that in the wild the actual multiplication factor was around 1000.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="provider-based-suspension">Provider-Based Suspension<a href="#provider-based-suspension" class="hash-link" aria-label="Direct link to Provider-Based Suspension" title="Direct link to Provider-Based Suspension">​</a></h3>
<p>It is also important to consider that servers are generally hosted not locally, but with hosting providers. Hosting providers have a legitimate business interest in preventing their network from being used for abuse, as failing to do so could result in other hosting providers and ISPs blocking their traffic altogether. As a result, many hosting providers employ mechanisms to detect unusual traffic from their servers and will “black hole” traffic to and from servers on their network emitting such traffic. This means that if an attacker wishes to take down a particular server, rather than overwhelm it with a traditional denial of service attack, they can simply make it appear as though the server itself is trying to engage in a denial of service attack. This will result in outbound traffic from the server being dropped by the provider, effectively having the same effect. We saw this occur, for example, with some Geyser services hosted on Hetzer as shown by the below MTR.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">mtr</span><span class="token plain"> pe.minetropical.net </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-rwbc</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">  	 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Start: </span><span class="token number">2024</span><span class="token plain">-03-28T18:24:58+0000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HOST: MS.local                                             	Loss%   Snt   Last   Avg  Best  Wrst StDev</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token number">1</span><span class="token plain">.</span><span class="token operator">|</span><span class="token plain">-- </span><span class="token number">172.16</span><span class="token plain">.0.1                                            	</span><span class="token number">0.0</span><span class="token plain">%	</span><span class="token number">10</span><span class="token plain">	</span><span class="token number">0.8</span><span class="token plain">   </span><span class="token number">1.2</span><span class="token plain">   </span><span class="token number">0.3</span><span class="token plain">   </span><span class="token number">4.6</span><span class="token plain">   </span><span class="token number">1.3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token number">2</span><span class="token plain">.</span><span class="token operator">|</span><span class="token plain">-- no-ptr.ziax.ltd </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">XXX.XXX.XXX.XXX</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                       	</span><span class="token number">0.0</span><span class="token plain">%	</span><span class="token number">10</span><span class="token plain">	</span><span class="token number">0.9</span><span class="token plain">   </span><span class="token number">0.8</span><span class="token plain">   </span><span class="token number">0.6</span><span class="token plain">   </span><span class="token number">1.4</span><span class="token plain">   </span><span class="token number">0.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token number">3</span><span class="token plain">.</span><span class="token operator">|</span><span class="token plain">-- </span><span class="token number">62.7</span><span class="token plain">.117.42                                           	</span><span class="token number">0.0</span><span class="token plain">%	</span><span class="token number">10</span><span class="token plain">	</span><span class="token number">7.5</span><span class="token plain">   </span><span class="token number">7.6</span><span class="token plain">   </span><span class="token number">7.2</span><span class="token plain">   </span><span class="token number">8.4</span><span class="token plain">   </span><span class="token number">0.3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token number">4</span><span class="token plain">.</span><span class="token operator">|</span><span class="token plain">-- core2-hu0-3-0-7.colindale.ukcore.bt.net </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">217.32</span><span class="token plain">.170.174</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  </span><span class="token number">0.0</span><span class="token plain">%	</span><span class="token number">10</span><span class="token plain">	</span><span class="token number">7.1</span><span class="token plain">   </span><span class="token number">7.2</span><span class="token plain">   </span><span class="token number">6.5</span><span class="token plain">   </span><span class="token number">8.2</span><span class="token plain">   </span><span class="token number">0.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token number">5</span><span class="token plain">.</span><span class="token operator">|</span><span class="token plain">-- core6-hu0-3-0-15.faraday.ukcore.bt.net </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">109.159</span><span class="token plain">.252.134</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token number">20.0</span><span class="token plain">%	</span><span class="token number">10</span><span class="token plain">	</span><span class="token number">7.5</span><span class="token plain">   </span><span class="token number">7.7</span><span class="token plain">   </span><span class="token number">7.0</span><span class="token plain">   </span><span class="token number">9.0</span><span class="token plain">   </span><span class="token number">0.6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token number">6</span><span class="token plain">.</span><span class="token operator">|</span><span class="token plain">-- </span><span class="token number">166</span><span class="token plain">-49-209-194.gia.bt.net </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">166.49</span><span class="token plain">.209.194</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">            	</span><span class="token number">0.0</span><span class="token plain">%	</span><span class="token number">10</span><span class="token plain">	</span><span class="token number">7.5</span><span class="token plain">   </span><span class="token number">7.6</span><span class="token plain">   </span><span class="token number">7.2</span><span class="token plain">   </span><span class="token number">8.8</span><span class="token plain">   </span><span class="token number">0.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token number">7</span><span class="token plain">.</span><span class="token operator">|</span><span class="token plain">-- t2c4-et-5-3-0.de-fra.gia.bt.net </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">166.49</span><span class="token plain">.195.103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">      	</span><span class="token number">0.0</span><span class="token plain">%	</span><span class="token number">10</span><span class="token plain">   </span><span class="token number">20.5</span><span class="token plain">  </span><span class="token number">21.4</span><span class="token plain">  </span><span class="token number">20.2</span><span class="token plain">  </span><span class="token number">24.5</span><span class="token plain">   </span><span class="token number">1.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token number">8</span><span class="token plain">.</span><span class="token operator">|</span><span class="token plain">-- decix-gw.hetzner.com </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">80.81</span><span class="token plain">.192.164</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                  	</span><span class="token number">0.0</span><span class="token plain">%	</span><span class="token number">10</span><span class="token plain">   </span><span class="token number">20.8</span><span class="token plain">  </span><span class="token number">20.8</span><span class="token plain">  </span><span class="token number">20.3</span><span class="token plain">  </span><span class="token number">22.0</span><span class="token plain">   </span><span class="token number">0.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token number">9</span><span class="token plain">.</span><span class="token operator">|</span><span class="token plain">-- core11.nbg1.hetzner.com </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">213.239</span><span class="token plain">.252.22</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">              	</span><span class="token number">0.0</span><span class="token plain">%	</span><span class="token number">10</span><span class="token plain">   </span><span class="token number">25.8</span><span class="token plain">  </span><span class="token number">26.2</span><span class="token plain">  </span><span class="token number">25.5</span><span class="token plain">  </span><span class="token number">29.3</span><span class="token plain">   </span><span class="token number">1.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">10</span><span class="token plain">.</span><span class="token operator">|</span><span class="token plain">-- blocked.hetzner.com </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">88.198</span><span class="token plain">.253.78</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                   	</span><span class="token number">0.0</span><span class="token plain">%	</span><span class="token number">10</span><span class="token plain">   </span><span class="token number">28.1</span><span class="token plain">  </span><span class="token number">35.7</span><span class="token plain">  </span><span class="token number">28.1</span><span class="token plain">  </span><span class="token number">76.1</span><span class="token plain">  </span><span class="token number">14.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">11</span><span class="token plain">.</span><span class="token operator">|</span><span class="token plain">-- ???                                                  	</span><span class="token number">100.0</span><span class="token plain">	</span><span class="token number">10</span><span class="token plain">	</span><span class="token number">0.0</span><span class="token plain">   </span><span class="token number">0.0</span><span class="token plain">   </span><span class="token number">0.0</span><span class="token plain">   </span><span class="token number">0.0</span><span class="token plain">   </span><span class="token number">0.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">12</span><span class="token plain">.</span><span class="token operator">|</span><span class="token plain">-- blocked.hetzner.com </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">88.198</span><span class="token plain">.253.78</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                  	</span><span class="token number">90.0</span><span class="token plain">%	</span><span class="token number">10</span><span class="token plain">  </span><span class="token number">2906</span><span class="token plain">. </span><span class="token number">2906</span><span class="token plain">. </span><span class="token number">2906</span><span class="token plain">. </span><span class="token number">2906</span><span class="token plain">.   </span><span class="token number">0.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>MTR (My Traceroute) shows the path packets take to a given Geyser server. In the 10th and 12th hop, we can see that the packet is being routed to the hostname blocked.hetzner.com, implying traffic to the server is being null-routed.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mitigation">Mitigation<a href="#mitigation" class="hash-link" aria-label="Direct link to Mitigation" title="Direct link to Mitigation">​</a></h2>
<p>Multiple forms of mitigation for this bug, as well as preventive measures to guard against future attacks have been introduced into Geyser and its upstream networking library. These include proper reliability handling during the early RakNet connection, early cookie verification, and rate limiting.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="proper-reliability-handling-in-early-raknet-connection">Proper Reliability Handling in Early RakNet Connection<a href="#proper-reliability-handling-in-early-raknet-connection" class="hash-link" aria-label="Direct link to Proper Reliability Handling in Early RakNet Connection" title="Direct link to Proper Reliability Handling in Early RakNet Connection">​</a></h3>
<p>The principal mitigation was changing the reliability type of the abused packet to unreliable. This means that the server will no longer respond to NAK requests for it, effectively leading to the attackers requests going unanswered. The packet capture below is taken from an instance with the reliability type of Connection Request Accepted changed to unreliable. We can see that the attacker simply continues to increment their packet range requested by NAK, but no response is provided.</p>
<table><thead><tr><th style="text-align:center"><img decoding="async" loading="lazy" alt="Wireshark Mitigated Attack" src="/assets/images/wireshark-mitigated-attack-4cb3252ba5b3d8a080778b7b54066b95.png" width="1193" height="1440" class="img_ev3q"></th></tr></thead><tbody><tr><td style="text-align:center"><em>Wireshark packet capture of a Geyser instance under attack with a build mitigating the original attack vector. The attacker is seen sending NAK packets with a sequence range of as high as 40,959. However, since the packet was not sent as reliable, there is nothing for the Geyser instance to send in response.</em></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="early-cookie-verification">Early Cookie Verification<a href="#early-cookie-verification" class="hash-link" aria-label="Direct link to Early Cookie Verification" title="Direct link to Early Cookie Verification">​</a></h3>
<p>The underlying issue that allows for UDP amplification attacks is a lack of verification at an early stage of the connection. The original RakNet protocol actually specifies an optional solution for this. For context, RakNet was purchased by Oculus in 2014, and open sourced. Given the acquisition of Oculus by Facebook, the code for the original implementation is now archived by them. While Mojang’s implementation of RakNet has some differences from the original, it does share many of the same features. In the packet Open Connection Reply 1, the original specification refers to a boolean HasSecurity, followed by a four byte cookie if the boolean is true.</p>
<table><thead><tr><th style="text-align:center"><img decoding="async" loading="lazy" alt="Original RakNet Packets" src="/assets/images/original-raknet-packets-3ea9ef70c8542767ae80b0be6ad69c3e.png" width="1337" height="571" class="img_ev3q"></th></tr></thead><tbody><tr><td style="text-align:center"><em>This is an excerpt from the original RakNet source containing the packet identifier enums. The comments above each enum define the packet structure. These packets from the initial login sequence are largely unchanged in Mojang’s RakNet implementation, though it does not appear that the client has any support for full encryption as defined in the original specification. This can be inferred because when the HasSecurity boolean and cookie is sent by the server in Open Connection Reply 1, Open Connection Request 2 by the client does include the cookie, but sets the clientSupportsSecurity boolean to false.</em></td></tr></tbody></table>
<p>It turns out that if a cookie is supplied by the Bedrock server in Open Connection Reply 1, the Bedrock client will reply with the same cookie. This allows us to effectively verify that the IP of the Bedrock client is not being spoofed by the third packet. Were the IP of the Bedrock client being spoofed, the packet containing the cookie would be sent to the victim’s IP and be unknown to the attacker. If the attacker sends back an incorrect cookie, the connection can be terminated at that point.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rate-limiting">Rate Limiting<a href="#rate-limiting" class="hash-link" aria-label="Direct link to Rate Limiting" title="Direct link to Rate Limiting">​</a></h3>
<p>In addition, Cloudburst Network also implemented three main rate limits to prevent further potential abuse of the protocol. These are summarized in the table below.</p>
<table><thead><tr><th>Name</th><th>RakNet Connection Stage</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td>RAK_PACKET_LIMIT</td><td>post-connection</td><td>per-ip per-tick (10ms) post-connection packet limit</td><td>120</td></tr><tr><td>RAK_GLOBAL_PACKET_LIMIT</td><td>post-connection</td><td>per-tick (10ms) overall packet limit</td><td>1000</td></tr></tbody></table>
<p>Geyser initially rolled out a fix that forced these defaults, but has since been <a href="https://github.com/GeyserMC/Geyser/pull/4532" target="_blank" rel="noopener noreferrer">updated</a> to allow them to be configured with system properties that are documented on the <a href="https://wiki.geyser.fastly.8aka.cn/geyser/geyser-command-line-arguments-and-system-properties/#disabling-warnings-and-advanced-configuration" target="_blank" rel="noopener noreferrer">Geyser Wiki</a>.</p>
<p>These defaults may present an issue to those running a reverse proxy in front of their Geyser instance, particularly those utilizing DDoS mitigation services like TCPShield and CosmicGuard, as to Network it will appear that all connections are originating from the same IP. To make configuration on these services easier, Geyser will disable these rate limits provided proxy protocol is enabled for the bedrock connection, and the Geyser instance is properly configured to only accept connections from the IPs of the proxy. To simplify this configuration, Geyser’s config can now accept a URL to specify proxy server IP ranges. Many DDoS mitigation providers have a static link to an always up to date text file of these.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">bedrock</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">enable-proxy-protocol</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token boolean important">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">proxy-protocol-whitelisted-ips</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;https://cosmic.global/ips/&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;https://tcpshield.com/v4/&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>Geyser configuration using a URL pointing a new-line separated text file containing allowed IPs for proxy-protocol usage.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="long-term-impact">Long Term Impact<a href="#long-term-impact" class="hash-link" aria-label="Direct link to Long Term Impact" title="Direct link to Long Term Impact">​</a></h2>
<p>It is extremely important that all those running vulnerable instances of Geyser update as soon as possible. Failure to do so may result in your Geyser instance being used to harm others via UDP denial of service amplification. We continue to see this issue being exploited in the wild as of the writing of this post, and see no reason that will stop in the foreseeable future. The number of unpatched instances will likely decrease over time as Bedrock updates force server owners to update in order to support players on the latest Bedrock version.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="acknowledgements">Acknowledgements<a href="#acknowledgements" class="hash-link" aria-label="Direct link to Acknowledgements" title="Direct link to Acknowledgements">​</a></h2>
<p>We thank the community for their patience as we addressed this issue, all those who responsibly disclosed this issue to us, the developers at Cloudburst and Geyser that worked to mitigate the issue, the server hosts that took an active role in ensuring instances on their hosting services were patched as soon as possible, all donors for their financial support of Geyser, and Cubecraft for their continued financial and operational support of the project.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/geyser-1-20-5"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Geyser Available for Java 1.20.5/1.20.6</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#timeline-utc" class="table-of-contents__link toc-highlight">Timeline (UTC)</a></li><li><a href="#initial-warning-signs" class="table-of-contents__link toc-highlight">Initial Warning Signs</a></li><li><a href="#initial-disclosure" class="table-of-contents__link toc-highlight">Initial Disclosure</a></li><li><a href="#reproduction-attempts" class="table-of-contents__link toc-highlight">Reproduction Attempts</a></li><li><a href="#live-analysis" class="table-of-contents__link toc-highlight">Live Analysis</a></li><li><a href="#effects" class="table-of-contents__link toc-highlight">Effects</a><ul><li><a href="#udp-amplification" class="table-of-contents__link toc-highlight">UDP Amplification</a></li><li><a href="#provider-based-suspension" class="table-of-contents__link toc-highlight">Provider-Based Suspension</a></li></ul></li><li><a href="#mitigation" class="table-of-contents__link toc-highlight">Mitigation</a><ul><li><a href="#proper-reliability-handling-in-early-raknet-connection" class="table-of-contents__link toc-highlight">Proper Reliability Handling in Early RakNet Connection</a></li><li><a href="#early-cookie-verification" class="table-of-contents__link toc-highlight">Early Cookie Verification</a></li><li><a href="#rate-limiting" class="table-of-contents__link toc-highlight">Rate Limiting</a></li></ul></li><li><a href="#long-term-impact" class="table-of-contents__link toc-highlight">Long Term Impact</a></li><li><a href="#acknowledgements" class="table-of-contents__link toc-highlight">Acknowledgements</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Wiki</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/wiki/geyser/setup">Geyser</a></li><li class="footer__item"><a class="footer__link-item" href="/wiki/floodgate/setup">Floodgate</a></li><li class="footer__item"><a class="footer__link-item" href="/wiki/api/api.geysermc.org/global-api">REST APIs</a></li><li class="footer__item"><a class="footer__link-item" href="/wiki/other/geyseroptionalpack">Other</a></li></ul></div><div class="col footer__col"><div class="footer__title">Downloads</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/download?project=geyser">Geyser</a></li><li class="footer__item"><a class="footer__link-item" href="/download?project=floodgate">Floodgate</a></li><li class="footer__item"><a class="footer__link-item" href="/download?project=other-projects">Other</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://translate.geysermc.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Crowdin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/geysermc" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/GeyserMC/Geyser" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.reddit.com/r/GeyserMC/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reddit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/Geyser_MC" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://opencollective.com/geysermc" target="_blank" rel="noopener noreferrer" class="footer__link-item">Donate<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://link.geysermc.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Global Linking</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/img/site/geyser-text.svg" alt="GeyserMC logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="430"><img src="/img/site/geyser-text.svg" alt="GeyserMC logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="430"></a></div><div class="footer__copyright">Copyright © 2025 GeyserMC. Built with Docusaurus.<br>This website is not an official Minecraft website and is not associated with Mojang Studios or Microsoft. All product and company names are trademarks or registered trademarks of their respective holders. Use of these names does not imply any affiliation or endorsement by them.</div></div></div></footer></div>
</body>
</html>